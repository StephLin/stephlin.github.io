import{u as M,f as te,g as se,h as G,i as ae,P as le,t as re,j as ie,k as O,l as C,m as ue,n as U,p as s,q as oe,R as T,s as ne,v as ce,x as pe,C as ve,y as he,z as ye,A as de,B as me,D as ge,E as Q,F as fe,G as He,H as Re,I as z,J as I,K as ke}from"./app-0FE73AsA.js";const xe=["/","/about-me.html","/projects/2022-KCP.html","/projects/2023-LIO-SEGMOT.html","/projects/2024-FracGM.html","/projects/2024-MTK-GNSS.html","/posts/Cpp/Cpp-traits.html","/posts/Optimization/Sum-of-squares.html","/posts/Python/Context-management.html","/posts/Python/Python-speedup.html","/404.html","/projects/","/posts/Cpp/","/posts/","/posts/Optimization/","/posts/Python/","/category/","/category/research/","/category/mediatek/","/category/c__/","/category/optimization/","/category/python/","/tag/","/tag/ra-l/","/tag/icra/","/tag/ion-gnss_/","/tag/c__/","/tag/traits/","/tag/template/","/tag/convex-optimization/","/tag/optimization/","/tag/sum-of-squares/","/tag/semidefinite-programming/","/tag/python/","/tag/context-management/","/tag/parallel-computing/","/tag/numpy/","/tag/pythran/","/tag/pybind11/","/article/","/star/","/timeline/"],qe="SEARCH_PRO_QUERY_HISTORY",g=M(qe,[]),Ce=()=>{const{queryHistoryCount:a}=Q,l=a>0;return{enabled:l,queryHistory:g,addQueryHistory:r=>{l&&(g.value=Array.from(new Set([r,...g.value.slice(0,a-1)])))},removeQueryHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}},_=a=>xe[a.id]+("anchor"in a?`#${a.anchor}`:""),Qe="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:$}=Q,f=M(Qe,[]),Se=()=>{const a=$>0;return{enabled:a,resultHistory:f,addResultHistory:l=>{if(a){const r={link:_(l),display:l.display};"header"in l&&(r.header=l.header),f.value=[r,...f.value.slice(0,$-1)]}},removeResultHistory:l=>{f.value=[...f.value.slice(0,l),...f.value.slice(l+1)]}}},we=a=>{const l=ve(),r=G(),S=he(),u=O(0),k=C(()=>u.value>0),y=ye([]);return de(()=>{const{search:d,terminate:w}=me(),H=ge(c=>{const R=c.join(" "),{searchFilter:P=h=>h,splitWord:L,suggestionsFilter:E,...m}=l.value;R?(u.value+=1,d(c.join(" "),r.value,m).then(h=>P(h,R,r.value,S.value)).then(h=>{u.value-=1,y.value=h}).catch(h=>{console.warn(h),u.value-=1,u.value||(y.value=[])})):y.value=[]},Q.searchDelay-Q.suggestDelay);U([a,r],([c])=>H(c),{immediate:!0}),fe(()=>{w()})}),{isSearching:k,results:y}};var Le=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:l}){const r=se(),S=G(),u=ae(le),{enabled:k,addQueryHistory:y,queryHistory:d,removeQueryHistory:w}=Ce(),{enabled:H,resultHistory:c,addResultHistory:R,removeResultHistory:P}=Se(),L=k||H,E=re(a,"queries"),{results:m,isSearching:h}=we(E),i=ie({isQuery:!0,index:0}),p=O(0),v=O(0),A=C(()=>L&&(d.value.length>0||c.value.length>0)),b=C(()=>m.value.length>0),j=C(()=>m.value[p.value]||null),K=()=>{const{isQuery:e,index:t}=i;t===0?(i.isQuery=!e,i.index=e?c.value.length-1:d.value.length-1):i.index=t-1},Y=()=>{const{isQuery:e,index:t}=i;t===(e?d.value.length-1:c.value.length-1)?(i.isQuery=!e,i.index=0):i.index=t+1},B=()=>{p.value=p.value>0?p.value-1:m.value.length-1,v.value=j.value.contents.length-1},J=()=>{p.value=p.value<m.value.length-1?p.value+1:0,v.value=0},N=()=>{v.value<j.value.contents.length-1?v.value+=1:J()},V=()=>{v.value>0?v.value-=1:B()},D=e=>e.map(t=>ke(t)?t:s(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=He[e.index]||"$content",[o,q=""]=Re(t)?t[S.value].split("$content"):t.split("$content");return e.display.map(n=>s("div",D([o,...n,q])))}return e.display.map(t=>s("div",D(t)))},x=()=>{p.value=0,v.value=0,l("updateQuery",""),l("close")},X=()=>k?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},u.value.queryHistory),d.value.map((e,t)=>s("div",{class:["search-pro-result-item",{active:i.isQuery&&i.index===t}],onClick:()=>{l("updateQuery",e)}},[s(z,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},e),s("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:o=>{o.preventDefault(),o.stopPropagation(),w(t)}})]))])):null,Z=()=>H?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},u.value.resultHistory),c.value.map((e,t)=>s(T,{to:e.link,class:["search-pro-result-item",{active:!i.isQuery&&i.index===t}],onClick:()=>{x()}},()=>[s(z,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[e.header?s("div",{class:"content-header"},e.header):null,s("div",e.display.map(o=>D(o)).flat())]),s("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:o=>{o.preventDefault(),o.stopPropagation(),P(t)}})]))])):null;return ue("keydown",e=>{if(a.isFocusing){if(b.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")N();else if(e.key==="Enter"){const t=j.value.contents[v.value];y(a.queries.join(" ")),R(t),r.push(_(t)),x()}}else if(H){if(e.key==="ArrowUp")K();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:t}=i;i.isQuery?(l("updateQuery",d.value[t]),e.preventDefault()):(r.push(c.value[t].link),x())}}}}),U([p,v],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>s("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!b.value:!A.value}],id:"search-pro-results"},a.queries.length?h.value?s(oe,{hint:u.value.searching}):b.value?s("ul",{class:"search-pro-result-list"},m.value.map(({title:e,contents:t},o)=>{const q=p.value===o;return s("li",{class:["search-pro-result-list-item",{active:q}]},[s("div",{class:"search-pro-result-title"},e||u.value.defaultTitle),t.map((n,ee)=>{const F=q&&v.value===ee;return s(T,{to:_(n),class:["search-pro-result-item",{active:F,"aria-selected":F}],onClick:()=>{y(a.queries.join(" ")),R(n),x()}},()=>[n.type==="text"?null:s(n.type==="title"?ne:n.type==="heading"?ce:pe,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?s("div",{class:"content-header"},n.header):null,s("div",W(n))])])})])})):u.value.emptyResult:L?A.value?[X(),Z()]:u.value.emptyHistory:u.value.emptyResult)}});export{Le as default};
